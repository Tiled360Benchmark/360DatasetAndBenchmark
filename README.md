# NVENC Benchmark

This repository contains the software developped for the paper *Benchmarking Hardware Encoding for Live 360° Video Tiled Streaming*.

[Access the data generated during this benchmark](https://github.com/Tiled360Benchmark/NVENCBenchmarkData).

If you use any part of this repository, please [cite our work](#citation).

## Installation

To run the [experiments](#experiments) :

1. Install [FFmpeg](https://ffmpeg.org/).
1. Install [Powershell](https://learn.microsoft.com/en-us/powershell/scripting/install/installing-powershell).
1. To run the [Spatial and Temporal Information experiment](#spatial-and-temporal-information), install [siti-tools](https://github.com/VQEG/siti-tools#requirements).

To generate the [plots](#analysis) :

1. Install the latest version of [Python 3.12](https://www.python.org/downloads/).
1. [Install the uv package manager](https://github.com/astral-sh/uv).
1. Install the required Python packages using `uv sync`.

## Experiments

The experiments generate the primary data needed for the research.
A description of each script parameters is available inside the script.

### Spatial and Temporal Information

This script calculates the spatial and temporal information of videos according to the [ITU-T P.910 (07/2022) recommendation](https://www.itu.int/rec/T-REC-P.910-202207-I/en) using the [reference software](https://github.com/VQEG/siti-tools).

#### Example usage :

```powershell
siTi.ps1 -tiles "tile1.y4m", "tile2.y4m" -resultsFile sitiTiles.csv
```

### Bitrate and Visual Quality Benchmark

This script evaluates the bitrate and visual quality of videos with differents encoding parameters.

#### Example usage :

```powershell
bitrateVmaf.ps1 -tiles "tile1.y4m", "tile2.y4m" -codecs "h264_nvenc", "hevc_nvenc" -presets "p1", "p2" -qps 18, 20 -heights 0, 320 -segmentTime 2 -segmentGOP 60 -segmentDirectory ".\segments" -dataFile data.csv -vmafLogDirectory "vmafLogs"
```

### Encoding Speed Benchmark

This script evaluates the time needed to encode the segments of the videos with different encoding parameters.

#### Example Usage

```powershell
encodingSpeed.ps1 -tiles "tile1.y4m", "tile2.y4m" -codecs "h264_nvenc", "hevc_nvenc" -presets "p1", "p2" -cqs 18, 20 -heights 0, 320 -repetitions 5 -segmentTime 2 -segmentGOP 60 -segmentDirectory ".\segment" -dataFile data.csv
```

## Analysis

These scripts plot the primary data generated by the experiments.
The following analyses are available :

- Bjøntegaard-Delta rate (`plotBdRate.py`)
- Encoding speed (`plotEncodingSpeed.py`)
- Spatial and temporal information (`plotSiTi.py`)
- Estimation errors (`plotEstimationError.py`)
- VMAF computing speed (`plotVmafSpeed`)

For usage, see each script in the `analysis` directory.

## Citation

To be added after acceptance.

## References

Bjøntegaard-Delta metrics calculation adapted from https://github.com/Anserw/Bjontegaard_metric
